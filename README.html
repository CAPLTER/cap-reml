<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<!-- readme.md is generated from readme.rmd. please edit the latter. -->

<h2 id="capeml-tools-to-aid-the-generation-of-eml-metadata">capeml: tools to aid the generation of eml metadata</h2>
<h3 id="overview">overview</h3>
<p>This package contains tools to aid the generation of eml metadata with intent to publish a dataset (data + metadata) in the Environmental Data Initiative (edi) data repository. Functions and a template work flow are included that allow for the creation of metadata at the dataset level, and individual data entities (e.g., other entities, data tables).</p>
<p>Helper functions for the creation of dataset metadata, <code>datatable()</code>, and <code>otherentity()</code> entities using the <a href="https://docs.ropensci.org/eml/">EML</a> package are supported. This package can be extended with the <a href="https://github.com/caplter/capemlgis">capemlGIS</a> package to generate metadata for <code>spatialraster()</code> and <code>spatialvector()</code> entities.</p>
<p>Note that the creation of people-related entities in the templated work flow (see below) are specific to functions that rely on Global Institute of Sustainability infrastructure; other users should add people using the list structure provided by ROpenSci’s <a href="https://docs.ropensci.org/eml/">EML</a>.</p>
<p>A template work flow to is included with this package. The template is automatically generated if a new project is created with <code>write_directory</code>, which also generates a <code>config.yaml</code> file and new directory, or with the <code>write_template</code> function. For Vim users, additional resources for templating are available through <a href="https://gitlab.com/caplter/capeml-vim">capeml-vim</a>.</p>
<h3 id="installation">installation</h3>
<p>Install from GitHub (after installing the <a href="https://cran.r-project.org/web/packages/devtools/index.html">devtools</a> package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;CAPLTER/capeml&quot;</span>)</a></code></pre></div>
<h3 id="options">options</h3>
<h4 id="eml">EML</h4>
<p>This package defaults to the current version of EML. Users can switch to the previous version with <code>emld::eml_version(&quot;eml-2.1.1&quot;)</code>.</p>
<h4 id="project-naming">project naming</h4>
<p>Most EML-generating functions in the capeml and capemlGIS packages will create both physical objects and EML references to those objects with the format: <code>project-id</code>_<code>object-name</code>_<code>object-hash</code>.<code>file-extension</code> (e.g., <em>664_site_map_5fb7b8d53d48010eab1a2e73db7f1941.png</em>). The target object (e.g., site_map.png from the previous example) is renamed with the additional metadata and this object name is referenced in the EML metadata. The only exception to this approach are spatialVectors (see capemlGIS) where the hash of the file/object is not included in the new object name. Note that the project-id is not passed to any of the functions, and must exist in <code>config.yaml</code> (as <code>projectid</code>).</p>
<p>Project-naming functionality can be turned off by setting the <code>projectNaming</code> option in <code>create_dataTable()</code> and <code>create_spatialRaster()</code> (also <code>create_spatialVector()</code> and <code>create_otherEntity()</code> from capemlGIS) to FALSE. When set to FALSE, the object name is not changed, and the file name of the object is included in the EML.</p>
<h3 id="getting-started">getting started</h3>
<h4 id="new-projects">new projects</h4>
<p>For new projects, <code>write_directory</code> will create a project directory at the current (default) or specified path. The package scope and number (e.g., edi.521) is passed as an argument, with the package identifier (sans the version number) becoming the directory name. Within the newly created directory, a template work flow as an Rmarkdown (Rmd) file with the package scope and number is generated and a <code>config.yaml</code>. In <code>config.yaml</code>, the package number and package identifier are generated as parameters. New projects assume a version number = 1, from which the package identifier (as <code>packageIdent</code>) is generated in <code>config.yaml</code>.</p>
<h4 id="existing-projects">existing projects</h4>
<p>For existing projects, if <code>config.yaml</code> does not already exist, <code>write_config</code> will generate <code>config.yaml</code> with the package scope and number (e.g., edi.521) passed as an argument to the function. A version number (default = 1) can be passed as a separate argument.</p>
<p>A template work flow as an Rmarkdown (Rmd) file named with the package scope and number can be generated independently with the <code>write_template</code> function.</p>
<h3 id="tools-to-generate-entity-metadata">tools to generate entity metadata</h3>
<ul>
<li><code>write_attributes()</code> creates a template as a csv file for supplying attribute metadata for a tabular data object that resides in the R environment</li>
<li><code>write_factors()</code> creates a template as a csv file for supplying code definition metadata for factors in a tabular data object that resides in the R environment</li>
</ul>
<h3 id="tools-to-create-eml-entities">tools to create EML entities</h3>
<ul>
<li><code>create_dataTable()</code> creates a EML entity of type dataTable</li>
<li><code>create_otherEntity()</code> creates a EML entity of type otherEntity</li>
</ul>
<h3 id="construct-a-dataset">construct a dataset</h3>
<h4 id="project-details-dataset-package-number-and-package-identifier">project details: dataset package number and package identifier</h4>
<p>The dataset number (e.g., 521) is read from the <code>packageNum</code> parameter of <code>config.yaml</code>. The package identifier (e.g. edi.521.4) is read from the <code>packageIdent</code> parameter of <code>config.yaml</code>.</p>
<h4 id="title">title</h4>
<p>The dataset title is read from the <code>title</code> parameter of <code>config.yaml</code>. The title can be quoted or unquoted but must be quoted if the title contains a colon.</p>
<h4 id="abstract">abstract</h4>
<p>The <code>create_dataset</code> function will look for a <code>abstract.md</code> file in the working directory or at the path provided if specified. <code>abstract.md</code> must be a markdown file.</p>
<h4 id="keywords">keywords</h4>
<p><code>write_keywords()</code> creates a template as a csv file for supplying dataset keywords. The <code>create_dataset</code> function will look for a <code>keywords.csv</code> file in the working directory or at the path provided if specified.</p>
<h4 id="methods">methods</h4>
<p>The <code>create_dataset</code> function will look for a <code>methods.md</code> file in the working directory or at the path provided if specified (<code>methods.md</code> must be a markdown file).</p>
<p>Alternatively, the work flow below is an enhanced approach of developing methods if provenance data are required or there are multiple methods files. If <code>enhancedMethods</code> exists, it will override arguments passed to <code>methodsFile</code> in <code>create_dataset</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(EDIutils)</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co"># methods from file tagged as markdown</span></a>
<a class="sourceLine" id="cb2-4" title="4">main &lt;-<span class="st"> </span><span class="kw">read_markdown</span>(<span class="st">&quot;~/Dropbox/development/knb-lter-cap.683/methods.md&quot;</span>)</a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co"># provenance: naip</span></a>
<a class="sourceLine" id="cb2-7" title="7">naip &lt;-<span class="st"> </span>emld<span class="op">::</span><span class="kw">as_emld</span>(EDIutils<span class="op">::</span><span class="kw">api_get_provenance_metadata</span>(<span class="st">&quot;knb-lter-cap.623.1&quot;</span>))</a>
<a class="sourceLine" id="cb2-8" title="8">naip<span class="op">$</span><span class="st">`</span><span class="dt">@context</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb2-9" title="9">naip<span class="op">$</span><span class="st">`</span><span class="dt">@type</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co"># provenance: lst</span></a>
<a class="sourceLine" id="cb2-12" title="12">landSurfaceTemp &lt;-<span class="st"> </span>emld<span class="op">::</span><span class="kw">as_emld</span>(EDIutils<span class="op">::</span><span class="kw">api_get_provenance_metadata</span>(<span class="st">&quot;knb-lter-cap.677.1&quot;</span>))</a>
<a class="sourceLine" id="cb2-13" title="13">landSurfaceTemp<span class="op">$</span><span class="st">`</span><span class="dt">@context</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb2-14" title="14">landSurfaceTemp<span class="op">$</span><span class="st">`</span><span class="dt">@type</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb2-15" title="15"></a>
<a class="sourceLine" id="cb2-16" title="16">enhancedMethods &lt;-<span class="st"> </span>EML<span class="op">::</span>eml<span class="op">$</span><span class="kw">methods</span>(<span class="dt">methodStep =</span> <span class="kw">list</span>(main, naip, landSurfaceTemp))</a></code></pre></div>
<h4 id="coverages">coverages</h4>
<p><em>Geographic</em> and <em>temporal</em> coverages are straight foward and documented in the work flow, but creating a <em>taxonomic</em> coverage is more involved. <em>Taxonomic coverage(s)</em> are constructed using EDI’s <a href="https://github.com/EDIorg/taxonomyCleanr">taxonomyCleanr</a> tool suite.</p>
<p>A sample work flow for creating a taxonomic coverage:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(taxonomyCleanr)</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3">my_path &lt;-<span class="st"> </span><span class="kw">getwd</span>() <span class="co"># taxonomyCleanr requires a path (to build the taxa_map)</span></a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co"># Example: draw taxonomic information from existing resource:</span></a>
<a class="sourceLine" id="cb3-6" title="6"></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co"># plant taxa listed in the om_transpiration_factors file</span></a>
<a class="sourceLine" id="cb3-8" title="8">plantTaxa &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;om_transpiration_factors.csv&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="st">  </span><span class="kw">filter</span>(attributeName <span class="op">==</span><span class="st"> &quot;species&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="st">  </span><span class="kw">as.data.frame</span>()</a>
<a class="sourceLine" id="cb3-11" title="11"></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co"># create or update map. A taxa_map.csv is the heart of taxonomyCleanr. This</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co"># function will build the taxa_map.csv and put it in the path identified with</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co"># my_path.</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="kw">create_taxa_map</span>(<span class="dt">path =</span> my_path, <span class="dt">x =</span> plantTaxa, <span class="dt">col =</span> <span class="st">&quot;definition&quot;</span>) </a>
<a class="sourceLine" id="cb3-16" title="16"></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co"># Example: construct taxonomic resource:</span></a>
<a class="sourceLine" id="cb3-18" title="18"></a>
<a class="sourceLine" id="cb3-19" title="19">gambelQuail &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">taxName =</span> <span class="st">&quot;Callipepla gambelii&quot;</span>)</a>
<a class="sourceLine" id="cb3-20" title="20"></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co"># Create or update map: a taxa_map.csv is the heart of taxonomyCleanr. This</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co"># function will build the taxa_map.csv in the path identified with my_path.</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="kw">create_taxa_map</span>(<span class="dt">path =</span> my_path, <span class="dt">x =</span> gambelQuail, <span class="dt">col =</span> <span class="st">&quot;taxName&quot;</span>) </a>
<a class="sourceLine" id="cb3-24" title="24"></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co"># Resolve taxa by attempting to match the taxon name (data.source 3 is ITIS but</span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co"># other sources are accessible). Use `resolve_comm_taxa` instead of</span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="co"># `resolve_sci_taxa` if taxa names are common names but note that ITIS</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co"># (data.source 3) is the only authority taxonomyCleanr will allow for common</span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="co"># names.</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="kw">resolve_sci_taxa</span>(<span class="dt">path =</span> my_path, <span class="dt">data.sources =</span> <span class="dv">3</span>) <span class="co"># in this case, 3 is ITIS</span></a>
<a class="sourceLine" id="cb3-31" title="31"></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="co"># build the EML taxonomomic coverage</span></a>
<a class="sourceLine" id="cb3-33" title="33">taxaCoverage &lt;-<span class="st"> </span><span class="kw">make_taxonomicCoverage</span>(<span class="dt">path =</span> my_path)</a>
<a class="sourceLine" id="cb3-34" title="34"></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="co"># add taxonomic to the other coverages</span></a>
<a class="sourceLine" id="cb3-36" title="36">coverage<span class="op">$</span>taxonomicCoverage &lt;-<span class="st"> </span>taxaCoverage</a></code></pre></div>
<h3 id="overview-create-a-datatable">overview: create a dataTable</h3>
<p>Given a rectangular data matrix of type dataframe or Tibble in the R environment:</p>
<p><code>write_attributes(data_entity)</code> will generate a template as a csv file in the working directory based on properties of the data entity such that metadata properties (e.g., attributeDefinition, units) can be added via a editor or spreadsheet application.</p>
<p><code>write_factors(data_entity)</code> will generate a template as a csv file in the working directory based on columns of the data entity that are factors such that details of factor levels can be added via a editor or spreadsheet application.</p>
<p><code>create_dataTable(data_entity)</code> performs many services:</p>
<ul>
<li>the data entity is written to file as a csv in the working directory with the file name: <em>projectid_data-entity-name_md5-hash-of-file.csv</em></li>
<li>metadata provided in the attributes and factors (if relevant) templates are ingested</li>
<li>a EML object of type dataTable is returned</li>
<li>note that the data entity name should be used consistently within the chunk, and the resulting dataTable entity should have the name: <em>data_entity_DT</em></li>
</ul>
<p><em>create_dataTable example: my_table</em></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">my_table &lt;-<span class="st"> </span>import <span class="op">/</span><span class="st"> </span>generate...process...</a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">write_attributes</span>(my_table)</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">write_factors</span>(my_table)</a>
<a class="sourceLine" id="cb4-5" title="5"></a>
<a class="sourceLine" id="cb4-6" title="6">my_table_desc &lt;-<span class="st"> &quot;description of table&quot;</span></a>
<a class="sourceLine" id="cb4-7" title="7"></a>
<a class="sourceLine" id="cb4-8" title="8">my_table_DT &lt;-<span class="st"> </span><span class="kw">create_dataTable</span>(</a>
<a class="sourceLine" id="cb4-9" title="9">  <span class="dt">dfname =</span> my_table,</a>
<a class="sourceLine" id="cb4-10" title="10">  <span class="dt">description =</span> my_table_desc</a>
<a class="sourceLine" id="cb4-11" title="11">)</a></code></pre></div>
<h3 id="overview-create-a-otherentity">overview: create a otherEntity</h3>
<p>A EML object of type otherEntity can be created from a single file or a directory. In the case of generating a otherEntity object from a directory, pass the directory path to the targetFile argument, capeml will recognize the target as a directory, and create a zipped file of the identified directory.</p>
<p>If the otherEntity object already is a zip file with the desired name, set the overwrite argument to FALSE to prevent overwriting the existing object.</p>
<p>As with all objects created with the capeml package, the resulting object is named with convention: projectid_object-name_md5sum-hash.file extension by default but this functionality can be turned off by setting projectNaming to FALSE.</p>
<h3 id="literature-cited">literature cited</h3>
<p>Though not provided as a function, below is a work flow for adding literature cited elements at the dataset level. The work flow capitalizes on EML version 2.2 that accepts the BibTex format for references.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># add literature cited if relevant</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">library</span>(rcrossref)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">library</span>(EML)</a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5">pub &lt;-<span class="st"> </span><span class="kw">cr_cn</span>(<span class="dt">dois =</span> <span class="st">&quot;https://doi.org/10.1186/s40317-015-0075-2&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;bibtex&quot;</span>)</a>
<a class="sourceLine" id="cb5-6" title="6">pub_cit &lt;-<span class="st"> </span>EML<span class="op">::</span>eml<span class="op">$</span><span class="kw">citation</span>(<span class="dt">id =</span> <span class="st">&quot;https://doi.org/10.1186/s40317-015-0075-2&quot;</span>)</a>
<a class="sourceLine" id="cb5-7" title="7">pub_cit<span class="op">$</span>bibtex &lt;-<span class="st"> </span>mccafferty</a>
<a class="sourceLine" id="cb5-8" title="8"></a>
<a class="sourceLine" id="cb5-9" title="9">citations &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb5-10" title="10">  <span class="dt">citation =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb5-11" title="11">    pub</a>
<a class="sourceLine" id="cb5-12" title="12">  ) <span class="co"># close list of citations</span></a>
<a class="sourceLine" id="cb5-13" title="13">) <span class="co"># close citation</span></a>
<a class="sourceLine" id="cb5-14" title="14"></a>
<a class="sourceLine" id="cb5-15" title="15">dataset<span class="op">$</span>literatureCited &lt;-<span class="st"> </span>citations</a></code></pre></div>

</body>
</html>
